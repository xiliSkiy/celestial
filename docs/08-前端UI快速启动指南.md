# Gravital Core å‰ç«¯ UI å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ å¿«é€Ÿæ­å»ºå’Œè¿è¡Œ Gravital Core çš„å‰ç«¯ UI é¡¹ç›®ã€‚

## ğŸ¨ UI é¢„è§ˆ

### ä¸»è¦é¡µé¢

#### 1. ç™»å½•é¡µé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚         Gravital Core               â”‚
â”‚         ç›‘æ§ç®¡ç†å¹³å°                 â”‚
â”‚                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚    â”‚ ç”¨æˆ·å: [______________]â”‚     â”‚
â”‚    â”‚ å¯†ç :   [______________]â”‚     â”‚
â”‚    â”‚ â–¡ è®°ä½æˆ‘                 â”‚     â”‚
â”‚    â”‚                         â”‚     â”‚
â”‚    â”‚      [ç™»å½•]             â”‚     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. ä»ªè¡¨ç›˜
- ç»Ÿè®¡å¡ç‰‡ï¼šè®¾å¤‡æ€»æ•°ã€åœ¨çº¿è®¾å¤‡ã€æ´»è·ƒå‘Šè­¦ã€ä»»åŠ¡æ•°
- å›¾è¡¨åŒºåŸŸï¼šè®¾å¤‡çŠ¶æ€åˆ†å¸ƒã€å‘Šè­¦è¶‹åŠ¿ã€Sentinel çŠ¶æ€ã€æ•°æ®è½¬å‘ç»Ÿè®¡
- æœ€è¿‘æ´»åŠ¨ï¼šå®æ—¶æ´»åŠ¨æ—¶é—´çº¿

#### 3. è®¾å¤‡ç®¡ç†
- è®¾å¤‡åˆ—è¡¨ï¼šæ”¯æŒæœç´¢ã€ç­›é€‰ã€åˆ†é¡µ
- è®¾å¤‡åˆ†ç»„ï¼šæ ‘å½¢ç»“æ„å±•ç¤º
- è®¾å¤‡è¯¦æƒ…ï¼šç›‘æ§æŒ‡æ ‡ã€é‡‡é›†ä»»åŠ¡ã€å‘Šè­¦è§„åˆ™

#### 4. Sentinel ç®¡ç†
- Sentinel å¡ç‰‡ï¼šæ˜¾ç¤ºçŠ¶æ€ã€æ€§èƒ½æŒ‡æ ‡
- Sentinel è¯¦æƒ…ï¼šç³»ç»Ÿä¿¡æ¯ã€è®¾å¤‡åˆ—è¡¨ã€æ€§èƒ½ç›‘æ§

#### 5. å‘Šè­¦ç®¡ç†
- å‘Šè­¦è§„åˆ™ï¼šåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤è§„åˆ™
- å‘Šè­¦äº‹ä»¶ï¼šå®æ—¶å‘Šè­¦æ—¶é—´çº¿
- å‘Šè­¦ç»Ÿè®¡ï¼šå›¾è¡¨å±•ç¤ºå‘Šè­¦è¶‹åŠ¿

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js >= 18.0.0
- npm >= 9.0.0

### æ­¥éª¤ 1: å®‰è£…ä¾èµ–

```bash
cd gravital-core/web
npm install
```

### æ­¥éª¤ 2: é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```env
# API åœ°å€
VITE_API_BASE_URL=http://localhost:8080

# WebSocket åœ°å€
VITE_WS_URL=ws://localhost:8080

# åº”ç”¨æ ‡é¢˜
VITE_APP_TITLE=Gravital Core
```

### æ­¥éª¤ 3: å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® http://localhost:5173

### æ­¥éª¤ 4: æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

æ„å»ºäº§ç‰©åœ¨ `dist/` ç›®å½•ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„è¯´æ˜

```
web/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/                    # API æ¥å£å°è£…
â”‚   â”‚   â”œâ”€â”€ request.ts          # Axios å°è£…
â”‚   â”‚   â”œâ”€â”€ device.ts           # è®¾å¤‡ API
â”‚   â”‚   â”œâ”€â”€ sentinel.ts         # Sentinel API
â”‚   â”‚   â”œâ”€â”€ alert.ts            # å‘Šè­¦ API
â”‚   â”‚   â””â”€â”€ forwarder.ts        # è½¬å‘å™¨ API
â”‚   â”‚
â”‚   â”œâ”€â”€ assets/                 # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ images/             # å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ icons/              # å›¾æ ‡
â”‚   â”‚   â””â”€â”€ styles/             # å…¨å±€æ ·å¼
â”‚   â”‚       â”œâ”€â”€ variables.scss  # SCSS å˜é‡
â”‚   â”‚       â”œâ”€â”€ mixins.scss     # SCSS Mixins
â”‚   â”‚       â””â”€â”€ global.scss     # å…¨å±€æ ·å¼
â”‚   â”‚
â”‚   â”œâ”€â”€ components/             # ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ common/             # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ StatCard.vue    # ç»Ÿè®¡å¡ç‰‡
â”‚   â”‚   â”‚   â”œâ”€â”€ ChartCard.vue   # å›¾è¡¨å¡ç‰‡
â”‚   â”‚   â”‚   â”œâ”€â”€ DataTable.vue   # æ•°æ®è¡¨æ ¼
â”‚   â”‚   â”‚   â””â”€â”€ StatusBadge.vue # çŠ¶æ€å¾½ç« 
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ business/           # ä¸šåŠ¡ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ DeviceCard.vue  # è®¾å¤‡å¡ç‰‡
â”‚   â”‚       â”œâ”€â”€ SentinelCard.vue # Sentinel å¡ç‰‡
â”‚   â”‚       â””â”€â”€ AlertTimeline.vue # å‘Šè­¦æ—¶é—´çº¿
â”‚   â”‚
â”‚   â”œâ”€â”€ composables/            # ç»„åˆå¼å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ useDevice.ts        # è®¾å¤‡ç›¸å…³é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ useAlert.ts         # å‘Šè­¦ç›¸å…³é€»è¾‘
â”‚   â”‚   â””â”€â”€ useWebSocket.ts     # WebSocket è¿æ¥
â”‚   â”‚
â”‚   â”œâ”€â”€ layouts/                # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ DefaultLayout.vue   # é»˜è®¤å¸ƒå±€
â”‚   â”‚   â””â”€â”€ BlankLayout.vue     # ç©ºç™½å¸ƒå±€ï¼ˆç™»å½•é¡µï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ router/                 # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ index.ts            # è·¯ç”±å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/                 # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ user.ts             # ç”¨æˆ·çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ device.ts           # è®¾å¤‡çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ sentinel.ts         # Sentinel çŠ¶æ€
â”‚   â”‚   â””â”€â”€ alert.ts            # å‘Šè­¦çŠ¶æ€
â”‚   â”‚
â”‚   â”œâ”€â”€ types/                  # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ device.ts           # è®¾å¤‡ç±»å‹
â”‚   â”‚   â”œâ”€â”€ sentinel.ts         # Sentinel ç±»å‹
â”‚   â”‚   â”œâ”€â”€ alert.ts            # å‘Šè­¦ç±»å‹
â”‚   â”‚   â””â”€â”€ api.ts              # API å“åº”ç±»å‹
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ format.ts           # æ ¼å¼åŒ–å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ validate.ts         # éªŒè¯å‡½æ•°
â”‚   â”‚   â””â”€â”€ storage.ts          # æœ¬åœ°å­˜å‚¨
â”‚   â”‚
â”‚   â”œâ”€â”€ views/                  # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Login.vue           # ç™»å½•é¡µ
â”‚   â”‚   â”œâ”€â”€ Dashboard.vue       # ä»ªè¡¨ç›˜
â”‚   â”‚   â”œâ”€â”€ Devices/            # è®¾å¤‡ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ List.vue        # è®¾å¤‡åˆ—è¡¨
â”‚   â”‚   â”‚   â””â”€â”€ Detail.vue      # è®¾å¤‡è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ Sentinels/          # Sentinel ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ List.vue
â”‚   â”‚   â”‚   â””â”€â”€ Detail.vue
â”‚   â”‚   â”œâ”€â”€ Tasks/              # ä»»åŠ¡ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ Alerts/             # å‘Šè­¦ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ Rules.vue       # å‘Šè­¦è§„åˆ™
â”‚   â”‚   â”‚   â””â”€â”€ Events.vue      # å‘Šè­¦äº‹ä»¶
â”‚   â”‚   â”œâ”€â”€ Forwarders/         # è½¬å‘å™¨ç®¡ç†
â”‚   â”‚   â””â”€â”€ Settings/           # ç³»ç»Ÿè®¾ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ App.vue                 # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ main.ts                 # å…¥å£æ–‡ä»¶
â”‚
â”œâ”€â”€ public/                     # å…¬å…±èµ„æº
â”‚   â””â”€â”€ favicon.ico
â”‚
â”œâ”€â”€ index.html                  # HTML æ¨¡æ¿
â”œâ”€â”€ package.json                # é¡¹ç›®é…ç½®
â”œâ”€â”€ tsconfig.json               # TypeScript é…ç½®
â”œâ”€â”€ vite.config.ts              # Vite é…ç½®
â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
```

## ğŸ¨ ä¸»é¢˜é…ç½®

### æš—è‰²ä¸»é¢˜ï¼ˆé»˜è®¤ï¼‰

```scss
// src/assets/styles/variables.scss
$dark-theme: (
  'bg-primary': #1a1a1a,
  'bg-secondary': #2d2d2d,
  'bg-tertiary': #3d3d3d,
  'text-primary': #ffffff,
  'text-secondary': #b3b3b3,
  'border-color': #404040,
  
  'color-primary': #409eff,
  'color-success': #67c23a,
  'color-warning': #e6a23c,
  'color-danger': #f56c6c,
  'color-info': #909399
);
```

### åˆ‡æ¢ä¸»é¢˜

```typescript
// src/composables/useTheme.ts
export function useTheme() {
  const theme = ref('dark')
  
  const toggleTheme = () => {
    theme.value = theme.value === 'dark' ? 'light' : 'dark'
    document.documentElement.setAttribute('data-theme', theme.value)
  }
  
  return { theme, toggleTheme }
}
```

## ğŸ”Œ API é›†æˆ

### é…ç½® Axios

```typescript
// src/api/request.ts
import axios from 'axios'

const request = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL,
  timeout: 30000
})

// è¯·æ±‚æ‹¦æˆªå™¨
request.interceptors.request.use(
  config => {
    const token = localStorage.getItem('token')
    if (token) {
      config.headers.Authorization = `Bearer ${token}`
    }
    return config
  },
  error => Promise.reject(error)
)

// å“åº”æ‹¦æˆªå™¨
request.interceptors.response.use(
  response => response.data,
  error => {
    if (error.response?.status === 401) {
      // è·³è½¬åˆ°ç™»å½•é¡µ
      router.push('/login')
    }
    return Promise.reject(error)
  }
)

export default request
```

### ä½¿ç”¨ API

```typescript
// src/api/device.ts
import request from './request'

export const deviceApi = {
  // è·å–è®¾å¤‡åˆ—è¡¨
  getDevices: (params: any) => 
    request.get('/api/v1/devices', { params }),
  
  // è·å–è®¾å¤‡è¯¦æƒ…
  getDevice: (id: string) => 
    request.get(`/api/v1/devices/${id}`),
  
  // åˆ›å»ºè®¾å¤‡
  createDevice: (data: any) => 
    request.post('/api/v1/devices', data)
}
```

## ğŸ“Š å›¾è¡¨é›†æˆ

### ä½¿ç”¨ ECharts

```vue
<template>
  <div ref="chartRef" style="width: 100%; height: 400px"></div>
</template>

<script setup lang="ts">
import * as echarts from 'echarts'
import { ref, onMounted, watch } from 'vue'

const chartRef = ref<HTMLElement>()
let chart: echarts.ECharts

const props = defineProps<{
  option: echarts.EChartsOption
}>()

onMounted(() => {
  if (chartRef.value) {
    chart = echarts.init(chartRef.value, 'dark')
    chart.setOption(props.option)
  }
})

watch(() => props.option, (newOption) => {
  chart?.setOption(newOption)
})
</script>
```

## ğŸ”„ å®æ—¶é€šä¿¡

### WebSocket é›†æˆ

```typescript
// src/composables/useWebSocket.ts
import { io } from 'socket.io-client'

export function useWebSocket() {
  const socket = io(import.meta.env.VITE_WS_URL)
  
  socket.on('connect', () => {
    console.log('WebSocket connected')
  })
  
  socket.on('device_status_change', (data) => {
    // æ›´æ–°è®¾å¤‡çŠ¶æ€
  })
  
  socket.on('alert_triggered', (data) => {
    // æ˜¾ç¤ºæ–°å‘Šè­¦
  })
  
  return { socket }
}
```

## ğŸ“± å“åº”å¼è®¾è®¡

### æ–­ç‚¹ä½¿ç”¨

```vue
<template>
  <div class="container">
    <div class="grid" :class="gridClass">
      <!-- å†…å®¹ -->
    </div>
  </div>
</template>

<script setup lang="ts">
import { useBreakpoints } from '@vueuse/core'

const breakpoints = useBreakpoints({
  mobile: 0,
  tablet: 768,
  laptop: 1024,
  desktop: 1280
})

const gridClass = computed(() => {
  if (breakpoints.mobile.value) return 'grid-1'
  if (breakpoints.tablet.value) return 'grid-2'
  if (breakpoints.laptop.value) return 'grid-3'
  return 'grid-4'
})
</script>

<style scoped>
.grid-1 { grid-template-columns: repeat(1, 1fr); }
.grid-2 { grid-template-columns: repeat(2, 1fr); }
.grid-3 { grid-template-columns: repeat(3, 1fr); }
.grid-4 { grid-template-columns: repeat(4, 1fr); }
</style>
```

## ğŸ” æƒé™æ§åˆ¶

### è·¯ç”±å®ˆå«

```typescript
// src/router/index.ts
router.beforeEach((to, from, next) => {
  const token = localStorage.getItem('token')
  
  if (to.meta.requiresAuth && !token) {
    next('/login')
  } else {
    next()
  }
})
```

### æŒ‰é’®æƒé™

```vue
<template>
  <el-button v-if="hasPermission('devices.write')" @click="createDevice">
    åˆ›å»ºè®¾å¤‡
  </el-button>
</template>

<script setup lang="ts">
import { useUserStore } from '@/stores/user'

const userStore = useUserStore()

const hasPermission = (permission: string) => {
  return userStore.permissions.includes(permission)
}
</script>
```

## ğŸš¢ éƒ¨ç½²

### Docker éƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t gravital-core-web:latest .

# è¿è¡Œå®¹å™¨
docker run -d -p 80:80 gravital-core-web:latest
```

### Nginx éƒ¨ç½²

```bash
# æ„å»º
npm run build

# å¤åˆ¶åˆ° Nginx ç›®å½•
cp -r dist/* /usr/share/nginx/html/

# é‡å¯ Nginx
nginx -s reload
```

## ğŸ› å¸¸è§é—®é¢˜

### 1. API è¯·æ±‚è·¨åŸŸ

**é—®é¢˜**: å¼€å‘ç¯å¢ƒä¸‹ API è¯·æ±‚è¢« CORS é˜»æ­¢

**è§£å†³**: åœ¨ `vite.config.ts` ä¸­é…ç½®ä»£ç†ï¼š

```typescript
server: {
  proxy: {
    '/api': {
      target: 'http://localhost:8080',
      changeOrigin: true
    }
  }
}
```

### 2. ç»„ä»¶è‡ªåŠ¨å¯¼å…¥å¤±è´¥

**é—®é¢˜**: Element Plus ç»„ä»¶æ— æ³•è‡ªåŠ¨å¯¼å…¥

**è§£å†³**: æ£€æŸ¥ `vite.config.ts` ä¸­çš„ `unplugin-vue-components` é…ç½®ï¼š

```typescript
Components({
  resolvers: [ElementPlusResolver()],
  dts: 'src/types/components.d.ts'
})
```

### 3. è·¯ç”± 404

**é—®é¢˜**: åˆ·æ–°é¡µé¢åå‡ºç° 404

**è§£å†³**: Nginx é…ç½® SPA è·¯ç”±ï¼š

```nginx
location / {
  try_files $uri $uri/ /index.html;
}
```

## ğŸ“š å‚è€ƒèµ„æº

- [Vue 3 å®˜æ–¹æ–‡æ¡£](https://cn.vuejs.org/)
- [Element Plus æ–‡æ¡£](https://element-plus.org/zh-CN/)
- [ECharts æ–‡æ¡£](https://echarts.apache.org/zh/index.html)
- [Vite æ–‡æ¡£](https://cn.vitejs.dev/)
- [Pinia æ–‡æ¡£](https://pinia.vuejs.org/zh/)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

**æ›´æ–°æ—¥æœŸ**: 2025-11-02  
**ç‰ˆæœ¬**: v1.0.0

