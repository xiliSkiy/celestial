# 拓扑功能快速开始指南

## 快速部署

### 1. 安装前端依赖

```bash
cd gravital-core/web
npm install @antv/g6
```

### 2. 运行数据库迁移

```bash
cd gravital-core
make migrate-up
```

### 3. 启动服务

```bash
# 后端
cd gravital-core
make run

# 前端（新终端）
cd gravital-core/web
npm run dev
```

### 4. 添加路由配置

在 `gravital-core/web/src/router/index.ts` 中添加：

```typescript
{
  path: '/topology',
  name: 'Topology',
  component: () => import('@/views/Topology/Index.vue'),
  meta: { 
    title: '网络拓扑', 
    requiresAuth: true,
    permission: 'topology.read'
  }
},
{
  path: '/topology/:id',
  name: 'TopologyDetail',
  component: () => import('@/views/Topology/Detail.vue'),
  meta: { 
    title: '拓扑详情', 
    requiresAuth: true,
    permission: 'topology.read'
  }
}
```

### 5. 添加菜单项

在侧边栏菜单配置中添加：

```typescript
{
  name: '网络拓扑',
  icon: 'Network',
  path: '/topology',
  permission: 'topology.read'
}
```

## 快速使用

### 创建第一个拓扑

1. 访问 `http://localhost:5173/topology`
2. 点击"创建拓扑"按钮
3. 填写信息：
   - 名称：数据中心核心网络
   - 类型：物理拓扑
   - 范围：数据中心
   - 布局：力导向
4. 点击"确定"

### 添加节点

1. 进入拓扑详情页
2. 点击"添加节点"
3. 填写信息：
   - 设备ID：dev-001
   - 标签：核心交换机-1
   - 类型：设备
   - 层级：0
4. 点击"确定"

### 添加链路

1. 重复上述步骤添加第二个节点
2. 点击"添加链路"
3. 选择源节点和目标节点
4. 填写接口信息
5. 点击"确定"

### 拖拽调整

- 直接拖拽节点到合适位置
- 系统会自动保存节点位置

### 切换布局

- 在工具栏选择不同的布局类型
- 支持：力导向、层次、环形、网格

## 权限配置

确保用户具有以下权限：

```json
{
  "topology.read": "查看拓扑",
  "topology.write": "创建和编辑拓扑",
  "topology.delete": "删除拓扑"
}
```

## 常见问题

### Q: G6 加载失败？
A: 确保已安装依赖 `npm install @antv/g6`

### Q: 拓扑无法显示？
A: 检查浏览器控制台是否有错误，确认 API 返回数据

### Q: 节点拖拽不生效？
A: 确认拓扑设置为可编辑模式

## 下一步

- 启用自动发现功能
- 创建版本快照
- 使用路径分析
- 使用影响分析

## 相关文档

- [详细设计文档](./14-设备网络拓扑详细设计.md)
- [实现说明文档](./15-拓扑功能实现说明.md)
- [实施总结文档](./16-拓扑功能实施总结.md)

