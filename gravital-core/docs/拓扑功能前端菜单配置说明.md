# 拓扑功能前端菜单配置说明

## 已完成的配置

### 1. 路由配置

在 `web/src/router/index.ts` 中添加了拓扑相关路由：

```typescript
{
  path: 'topology',
  name: 'Topology',
  component: () => import('@/views/Topology/Index.vue'),
  meta: { title: '网络拓扑' }
},
{
  path: 'topology/:id',
  name: 'TopologyDetail',
  component: () => import('@/views/Topology/Detail.vue'),
  meta: { title: '拓扑详情' }
}
```

**路由说明**:
- `/topology` - 拓扑列表页面
- `/topology/:id` - 拓扑详情页面（可视化展示）

### 2. 侧边栏菜单

在 `web/src/layouts/DefaultLayout.vue` 中添加了拓扑菜单项：

```vue
<el-menu-item 
  v-if="hasPermission('topology.read')" 
  index="/topology"
>
  <el-icon><Share /></el-icon>
  <template #title>网络拓扑</template>
</el-menu-item>
```

**菜单特性**:
- 图标: `Share` (网络分享图标)
- 标题: 网络拓扑
- 权限: `topology.read`
- 位置: 告警管理和数据转发之间

### 3. 工具函数

创建了 `web/src/utils/format.ts` 格式化工具函数库：

```typescript
// 日期时间格式化
formatDateTime(dateString, format)
formatDate(dateString)
formatTime(dateString)
formatRelativeTime(dateString)

// 数值格式化
formatNumber(num, decimals)
formatPercent(value, decimals)
formatBandwidth(bps)
formatFileSize(bytes)
formatDuration(seconds)

// 字符串格式化
formatIP(ip)
truncate(str, maxLength, suffix)
```

## 菜单层级结构

更新后的侧边栏菜单结构：

```
📊 仪表盘
🖥️ 设备管理
🧭 Sentinel 管理
📋 任务管理
🔔 告警管理
🌐 网络拓扑  ← 新增
🔗 数据转发
⚙️ 系统设置
```

## 权限配置

### 前端权限检查

菜单项使用 `hasPermission('topology.read')` 进行权限检查，只有具有该权限的用户才能看到菜单项。

### 后端权限配置

需要在后端权限系统中配置以下权限：

```json
{
  "topology.read": {
    "name": "查看拓扑",
    "description": "查看网络拓扑列表和详情"
  },
  "topology.write": {
    "name": "编辑拓扑",
    "description": "创建、编辑拓扑和节点链路"
  },
  "topology.delete": {
    "name": "删除拓扑",
    "description": "删除拓扑图"
  },
  "topology.discover": {
    "name": "触发发现",
    "description": "触发自动拓扑发现"
  }
}
```

## 使用流程

### 1. 访问拓扑列表

用户点击侧边栏"网络拓扑"菜单项 → 跳转到 `/topology` → 显示拓扑列表页面

### 2. 查看拓扑详情

在拓扑列表中点击某个拓扑 → 跳转到 `/topology/:id` → 显示拓扑可视化页面

### 3. 面包屑导航

顶部面包屑会自动显示当前路径：
- 拓扑列表: `首页 / 网络拓扑`
- 拓扑详情: `首页 / 拓扑详情`

## 图标说明

使用的图标来自 Element Plus Icons：

- `Share` - 网络分享图标，表示网络拓扑的连接关系
- 其他可选图标:
  - `Connection` - 连接图标
  - `Grid` - 网格图标
  - `Share` - 分享图标（当前使用）

## 样式说明

菜单项样式继承自 DefaultLayout：
- 默认状态: 灰色图标和文字
- 激活状态: 蓝色高亮
- 悬停状态: 浅蓝色背景
- 折叠状态: 只显示图标

## 响应式设计

- **展开状态** (宽度 200px): 显示图标和文字
- **折叠状态** (宽度 64px): 只显示图标
- 点击左上角折叠按钮可切换状态

## 测试清单

### 功能测试

- [ ] 菜单项正确显示
- [ ] 点击菜单项正确跳转
- [ ] 权限控制正常工作
- [ ] 面包屑导航正确显示
- [ ] 菜单激活状态正确

### 权限测试

- [ ] 无权限用户看不到菜单项
- [ ] 有 `topology.read` 权限的用户可以看到菜单
- [ ] 权限检查在路由守卫中生效

### 样式测试

- [ ] 菜单项样式正常
- [ ] 图标显示正常
- [ ] 激活状态高亮正常
- [ ] 折叠状态正常

## 常见问题

### Q: 菜单项不显示？

A: 检查以下几点：
1. 用户是否有 `topology.read` 权限
2. 路由配置是否正确
3. 组件文件是否存在
4. 浏览器控制台是否有错误

### Q: 点击菜单无反应？

A: 检查：
1. 路由配置中的 `index` 属性是否正确
2. 路由守卫是否拦截
3. 组件是否正确导入

### Q: 图标不显示？

A: 确保：
1. Element Plus Icons 已正确安装
2. 图标名称正确（区分大小写）
3. 组件中已导入图标

## 下一步

完成菜单配置后，可以：

1. **配置权限**: 在后端添加拓扑相关权限
2. **分配权限**: 给用户或角色分配权限
3. **测试功能**: 访问拓扑页面测试功能
4. **优化体验**: 根据用户反馈调整

## 相关文件

- `web/src/router/index.ts` - 路由配置
- `web/src/layouts/DefaultLayout.vue` - 侧边栏布局
- `web/src/utils/format.ts` - 格式化工具函数
- `web/src/views/Topology/Index.vue` - 拓扑列表页面
- `web/src/views/Topology/Detail.vue` - 拓扑详情页面

## 总结

✅ 路由配置完成
✅ 侧边栏菜单添加完成
✅ 权限控制集成完成
✅ 工具函数创建完成
✅ 面包屑导航自动生成

拓扑功能已完全集成到前端系统中，用户可以通过侧边栏菜单访问！

